<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameBox</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <div id="left">LEFT</div>
    <div id="right">RIGHT</div>
    <h1 id="title">GAME BOX</h1>
    <div id="now">기억력테스트</div>
    <div id="con">
        <div id="one" class="container">
            <div id="memoryOrder" class="front">
                <div id="memory_cover">
                    <div id="memory_msg"></div>
                    <div id="memory_game">시작하기</div>
                </div>
                <div id="memory_innerCover"></div>
                <div id="memory_container"></div>
            </div>
            <div class="back"></div>
        </div>
        <div id="two" class="container">
            <div class="front">TWO</div>
            <div class="back"></div>
        </div>
        <div id="three" class="container">
            <div class="front">THREE</div>
            <div class="back"></div>
        </div>
    </div>
    <div id="floor"></div>
    <div id="desk"></div>
    <div id="upperBackground"></div>
    <div id="lowerBackground"></div>
    <script>
        //회전목마 파트
        {
        const left = document.getElementById('left');
        const right = document.getElementById('right');

        const containers = document.querySelectorAll('.container')
        
        let arr = [0, 120, 240]
        let pos = [2,0,1]; // [0,1,2]
        left.addEventListener('click', () => {
            pos=pos.map(el=> el+1===3 ? 0 : el+1);
            containers.forEach((el, idx) => {
                arr[idx] = arr[idx]-120;
                
                el.style.transform =
                    `translateZ(8000px) translateX(${pos[1]===idx ? 0 : pos[0] === idx ? '-700px' : '700px'}) scale(${pos[1]===idx ? 1 : 0.5}) rotateY(${arr[idx]}deg)`;
            })
            console.log(arr)
            console.log(pos);
        })
        right.addEventListener('click', () => {
            pos=pos.map(el=> el-1===-1 ? 2 : el-1);
            containers.forEach((el, idx) => {
                arr[idx] = arr[idx] + 120;
                el.style.transform =
                    `translateZ(8000px) translateX(${pos[1]===idx ? 0 : pos[0] === idx  ? '-700px' : '700px'}) scale(${pos[1]===idx ? 1 : 0.5}) rotateY(${arr[idx]}deg)`;
            })
            console.log(arr)
            console.log(pos);
        })
    }
        
        //순서 맞추기 파트
        {
            let orderStage = 1;
            const orderStart=document.getElementById('memory_game');
            const orderCover = document.getElementById('memory_cover');
            orderStart.addEventListener("click",()=>{
                orderCover.classList.add('memory_start');
            })
            const orderArray = createRandomOrder(orderStage);
            makeOrderGame(orderStage);
            orderGameStart(orderArray);
            function orderGameStart(orderArray){
                const boxes = document.querySelectorAll('.memory_box');
                orderArray.forEach((el,idx)=>{
                    setTimeout(()=>{
                        boxes[el].style.background='red';
                        
                    },1000+idx*500)
                    setTimeout(()=>{
                            boxes[el].style.background='white';
                        },1500+idx*500);
                })
            }
            function makeOrderGame(orderStage){
                const container = document.getElementById('memory_container');
                container.innerHTML='';
                for(let i=0;i<orderStage+2;i++){
                    const row = document.createElement('div');
                    row.style.height=`${90/(orderStage+2)}%`;
                    row.classList.add('memory_row');
                    for(let j=0;j<orderStage+2;j++){
                        const box = document.createElement('div');
                        box.classList.add('memory_box');
                        box.style.width=`${90/(orderStage+2)}%`
                        row.appendChild(box);
                    }
                    container.appendChild(row);
                }
            }
            function createRandomOrder(stage){
                const n = Math.pow(stage+2,2);
                const arr = new Array(n).fill(0).map((el,idx)=>idx);
                const result=[];
                for(let i=0;i<n;i++){
                    const rand = Math.floor(Math.random()*arr.length);
                    result.push(arr.splice(rand,1)[0]);
                }
                return result;
            }
        }
    </script>
</body>

</html>